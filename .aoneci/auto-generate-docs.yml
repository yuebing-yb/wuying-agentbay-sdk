# AgentBay SDK Auto Documentation Generation Pipeline
name: "AgentBay SDK Auto-generate Documentation"

params:
  auto_commit_enabled:
    name: Enable Auto Commit Documentation
    type: boolean
    default: true
    description: "Whether to automatically commit generated documentation to current MR branch"
  
  python_docs_enabled:
    name: Enable Python Documentation Generation
    type: boolean
    default: true
  
  typescript_docs_enabled:
    name: Enable TypeScript Documentation Generation
    type: boolean
    default: true
  
  golang_docs_enabled:
    name: Enable Golang Documentation Generation
    type: boolean
    default: true
  
  llms_docs_enabled:
    name: Enable AI Assistant Documentation Generation
    type: boolean
    default: true
    description: "Generate llms.txt and llms-full.txt files"
  
  runs_on_resources:
    name: Resource Specification
    description: "Runtime container resource specification"
    default: "4-16Gi"
    options:
      - "4-16Gi"
      - "8-32Gi"
      - "16-64Gi"

jobs:
  # Auto documentation generation job
  auto-generate-docs:
    continue-on-error: false
    name: "Auto Generate Documentation"
    runs-on:
      - "${{params.runs_on_resources}}"
    image: alios-8u
    timeout: 45m
    retry:
      max: 2
      when:
        - runner_system_failure
        - stuck_or_timeout_failure
    
    steps:
      - uses: checkout
        inputs:
          fetch-depth: 0
          username: 'wuying-ai-team'
          # 使用 private-token 以支持 push 操作
          token: ${{secrets.PRIVATE_TOKEN}}
      
      # Check if it's a CI bot commit to avoid infinite loops
      - id: check-ci-loop
        name: "Check CI Loop"
        continue-on-error: false
        run: |
          echo "🔍 Checking if this is a CI bot commit..."
          
          # Get latest commit information
          LATEST_COMMIT_MESSAGE=$(git log -1 --pretty=format:"%s" | cat)
          LATEST_COMMIT_AUTHOR=$(git log -1 --pretty=format:"%ae" | cat)
          
          echo "Latest commit message: $LATEST_COMMIT_MESSAGE"
          echo "Latest commit author: $LATEST_COMMIT_AUTHOR"
          
          # Check if it's a CI bot commit
          if [[ "$LATEST_COMMIT_MESSAGE" == *"🤖 Auto-generate documentation"* ]] || \
             [[ "$LATEST_COMMIT_AUTHOR" == "wuying-ai-team@alibabacloud.com" ]]; then
            echo "⚠️  Detected CI bot commit, skipping documentation generation to avoid infinite loop"
            echo "CI_LOOP_DETECTED=true" >> $AONE_CI_ENV
            exit 1
          else
            echo "✅ Not a CI bot commit, continuing with documentation generation"
            echo "CI_LOOP_DETECTED=false" >> $AONE_CI_ENV
          fi
      
      # 设置多语言环境
      - uses: setup-env
        inputs:
          python-version: '3.11'
          node-version: '18'
          go-version: '1.24.3'
          npm-cache: true
          pip-cache: true
          go-mod-cache: true
          go-cache: true
      
      # Create temporary documentation directory
      - id: setup-temp-docs
        name: "Setup Temporary Documentation Directory"
        run: |
          # Check if it's a CI bot commit
          if [ "$CI_LOOP_DETECTED" = "true" ]; then
            echo "⚠️ Detected CI bot commit, skipping temporary documentation directory creation"
            exit 0
          fi
          
          echo "📁 Creating CI/CD temporary documentation directory..."
          
          # Use workspace directory instead of /tmp to ensure sharing between steps
          TEMP_DOCS_DIR="$PWD/.temp-docs"
          mkdir -p "$TEMP_DOCS_DIR"/{python,typescript,golang,llms}
          
          echo "✅ Temporary documentation directory created: $TEMP_DOCS_DIR"
          echo "TEMP_DOCS_DIR=$TEMP_DOCS_DIR" >> $AONE_CI_ENV
          
          # Display directory structure
          echo "📋 Temporary directory structure:"
          tree "$TEMP_DOCS_DIR" || ls -la "$TEMP_DOCS_DIR"
      
      # Generate Python API documentation
      - id: generate-python-docs
        name: "Generate Python API Documentation"
        when: ${{params.python_docs_enabled}}
        run: |
          # Check if it's a CI bot commit or Python documentation generation is disabled
          if [ "$CI_LOOP_DETECTED" = "true" ]; then
            echo "⚠️ Detected CI bot commit, skipping Python API documentation generation"
            exit 0
          fi
          
          echo "🐍 Starting Python API documentation generation..."
          echo "  - CI_LOOP_DETECTED: ${CI_LOOP_DETECTED:-not set}"
          cd python
          
          # Install dependencies
          python -m pip config set global.timeout 300
          python -m pip config set global.retries 3
          python -m pip install --upgrade pip
          # Install additional dependencies required for documentation generation
          pip install docspec pyyaml pydoc-markdown
          
          # Generate documentation
          python scripts/generate_api_docs.py
          
          # Verify generated documentation
          if [ -d "docs/api" ]; then
            echo "📋 Verifying generated API documentation:"
            find docs/api -name "*.md" | head -5 | while read file; do
              echo "  - $file"
            done
          else
            echo "⚠️ Generated API documentation directory not found: docs/api"
          fi
          
          # Copy generated Python API documentation to temporary directory
          cd ..
          if [ -d "python/docs/api" ]; then
            echo "📋 Copying generated Python API documentation to temporary directory..."
            # Ensure temporary directory exists
            mkdir -p "$TEMP_DOCS_DIR/python"
            cp -r python/docs/api "$TEMP_DOCS_DIR/python/" 2>/dev/null || true
            
            # Display copied files
            COPIED_FILES=$(find "$TEMP_DOCS_DIR/python" -type f 2>/dev/null || true)
            if [ -n "$COPIED_FILES" ]; then
              echo "✅ Python API documentation copied to temporary directory:"
              echo "$COPIED_FILES"
            else
              echo "⚠️ No Python API documentation was copied"
            fi
          else
            echo "⚠️ Generated Python API documentation directory not found: python/docs/api"
          fi
          tree "$TEMP_DOCS_DIR" || ls -la "$TEMP_DOCS_DIR"
          echo "✅ Python API documentation generation completed and staged"
      
      # Generate TypeScript API documentation
      - id: generate-typescript-docs
        name: "Generate TypeScript API Documentation"
        when: ${{params.typescript_docs_enabled}}
        run: |
          # Check if it's a CI bot commit or TypeScript documentation generation is disabled
          if [ "$CI_LOOP_DETECTED" = "true" ]; then
            echo "⚠️ Detected CI bot commit, skipping TypeScript API documentation generation"
            exit 0
          fi
          
          echo "📘 Starting TypeScript API documentation generation..."
          cd typescript
          
          # Configure npm timeout and retry strategy
          npm config set fetch-timeout 300000
          npm config set fetch-retry-mintimeout 20000
          npm config set fetch-retry-maxtimeout 120000
          
          # Install dependencies
          npm ci --prefer-offline --no-audit
          
          # Generate documentation
          npm run docs:generate
          
          # Verify generated documentation
          if [ -d "docs/api" ]; then
            echo "📋 Verifying generated API documentation:"
            find docs/api -name "*.md" | head -5 | while read file; do
              echo "  - $file"
            done
          else
            echo "⚠️ Generated API documentation directory not found: docs/api"
          fi
          
          # Copy generated TypeScript API documentation to temporary directory
          cd ..
          if [ -d "typescript/docs/api" ]; then
            echo "📋 Copying generated TypeScript API documentation to temporary directory..."
            # Ensure temporary directory exists
            mkdir -p "$TEMP_DOCS_DIR/typescript"
            cp -r typescript/docs/api "$TEMP_DOCS_DIR/typescript/" 2>/dev/null || true
            
            # Display copied files
            COPIED_FILES=$(find "$TEMP_DOCS_DIR/typescript" -type f 2>/dev/null || true)
            if [ -n "$COPIED_FILES" ]; then
              echo "✅ TypeScript API documentation copied to temporary directory:"
              echo "$COPIED_FILES"
            else
              echo "⚠️ No TypeScript API documentation was copied"
            fi
          else
            echo "⚠️ Generated TypeScript API documentation directory not found: typescript/docs/api"
          fi
          tree "$TEMP_DOCS_DIR" || ls -la "$TEMP_DOCS_DIR"
          echo "✅ TypeScript API documentation generation completed and staged"
      
      
      
      # Generate AI Assistant documentation
      - id: generate-llms-docs
        name: "Generate AI Assistant Documentation"
        when: ${{params.llms_docs_enabled}}
        run: |
          # Check if it's a CI bot commit or AI Assistant documentation generation is disabled
          if [ "$CI_LOOP_DETECTED" = "true" ]; then
            echo "⚠️ Detected CI bot commit, skipping AI Assistant documentation generation"
            exit 0
          fi
          
          echo "🤖 Starting AI Assistant documentation generation..."
          
          # Install necessary dependencies
          pip install markdown beautifulsoup4 tiktoken pyyaml
          
          # Generate llms.txt and llms-full.txt
          python scripts/build_llms_txt.py
          tree "$TEMP_DOCS_DIR" || ls -la "$TEMP_DOCS_DIR"
          # Copy generated AI Assistant documentation to temporary directory
          for llms_file in "llms.txt" "llms-full.txt"; do
            if [ -f "$llms_file" ]; then
              echo "📋 Copying AI Assistant documentation to temporary directory: $llms_file"
              # Ensure temporary directory exists
              mkdir -p "$TEMP_DOCS_DIR/llms"
              cp "$llms_file" "$TEMP_DOCS_DIR/llms/"
              echo "✅ Copied $llms_file"
            fi
          done
          
          echo "✅ AI Assistant documentation generation completed and staged"
      

      # Generate Golang API documentation
      - id: generate-golang-docs
        name: "Generate Golang API Documentation"
        when: ${{params.golang_docs_enabled}}
        run: |
          # Check if it's a CI bot commit or Golang documentation generation is disabled
          if [ "$CI_LOOP_DETECTED" = "true" ]; then
            echo "⚠️ Detected CI bot commit, skipping Golang API documentation generation"
            exit 0
          fi

          echo "🐹 Starting Golang API documentation generation..."
          cd golang
          
          # Configure Go environment
          export GOPROXY=https://goproxy.cn,direct
          export GOSUMDB=sum.golang.org
          echo "✅ Go environment configured: GOPROXY=$GOPROXY"
          
          # Download dependencies
          go mod download
          go mod verify
          
          # Generate documentation
          go run scripts/generate_api_docs.go
          
          # Verify generated documentation
          if [ -d "docs/api" ]; then
            echo "📋 Verifying generated API documentation:"
            find docs/api -name "*.md" | head -5 | while read file; do
              echo "  - $file"
            done
          else
            echo "⚠️ Generated API documentation directory not found: docs/api"
          fi
          
          # Copy generated Golang API documentation to temporary directory
          cd ..
          if [ -d "golang/docs/api" ]; then
            echo "📋 Copying generated Golang API documentation to temporary directory..."
            # Ensure temporary directory exists
            mkdir -p "$TEMP_DOCS_DIR/golang"
            cp -r golang/docs/api "$TEMP_DOCS_DIR/golang/" 2>/dev/null || true
            
            # Display copied files
            COPIED_FILES=$(find "$TEMP_DOCS_DIR/golang" -type f 2>/dev/null || true)
            if [ -n "$COPIED_FILES" ]; then
              echo "✅ Golang API documentation copied to temporary directory:"
              echo "$COPIED_FILES"
            else
              echo "⚠️ No Golang API documentation was copied"
            fi
          else
            echo "⚠️ Generated Golang API documentation directory not found: golang/docs/api"
          fi
          
          tree "$TEMP_DOCS_DIR" || ls -la "$TEMP_DOCS_DIR"
          echo "✅ Golang API documentation generation completed and staged"
      
      # Copy documentation from temporary directory to project directory and stage
      - id: copy-and-stage-docs
        name: "Copy Documentation to Project and Stage"
        run: |
          # Check if it's a CI bot commit
          if [ "$CI_LOOP_DETECTED" == "true" ]; then
            echo "⚠️ Detected CI bot commit, skipping documentation copy and staging"
            exit 0
          fi
          
          echo "📋 Copying documentation from temporary directory to project directory and staging..."
          
          # Check if temporary directory exists with files
          if [ ! -d "$TEMP_DOCS_DIR" ]; then
            echo "⚠️ Temporary documentation directory does not exist: $TEMP_DOCS_DIR"
            exit 0
          fi
          
          echo "📁 Temporary directory contents:"
          find "$TEMP_DOCS_DIR" -type f 2>/dev/null || echo "Temporary directory is empty"
          
          # 复制并暂存 Python API 文档
          if [ -d "$TEMP_DOCS_DIR/python/api" ] && [ "$(find "$TEMP_DOCS_DIR/python/api" -type f 2>/dev/null)" ]; then
            echo "📋 复制 Python API 文档到项目目录..."
            mkdir -p python/docs/api
            cp -r "$TEMP_DOCS_DIR/python/api"/* python/docs/api/ 2>/dev/null || true
            git add python/docs/api/
            echo "✅ Python API 文档已复制并暂存"
          fi
          
          # 复制并暂存 TypeScript API 文档
          if [ -d "$TEMP_DOCS_DIR/typescript/api" ] && [ "$(find "$TEMP_DOCS_DIR/typescript/api" -type f 2>/dev/null)" ]; then
            echo "📋 复制 TypeScript API 文档到项目目录..."
            mkdir -p typescript/docs/api
            cp -r "$TEMP_DOCS_DIR/typescript/api"/* typescript/docs/api/ 2>/dev/null || true
            git add typescript/docs/api/
            echo "✅ TypeScript API 文档已复制并暂存"
          fi
          
          # 复制并暂存 Golang API 文档
          if [ -d "$TEMP_DOCS_DIR/golang/api" ] && [ "$(find "$TEMP_DOCS_DIR/golang/api" -type f 2>/dev/null)" ]; then
            echo "📋 复制 Golang API 文档到项目目录..."
            mkdir -p golang/docs/api
            cp -r "$TEMP_DOCS_DIR/golang/api"/* golang/docs/api/ 2>/dev/null || true
            git add golang/docs/api/
            echo "✅ Golang API 文档已复制并暂存"
          fi
          
          # 复制并暂存 AI 助手文档
          if [ -d "$TEMP_DOCS_DIR/llms" ] && [ "$(find "$TEMP_DOCS_DIR/llms" -type f 2>/dev/null)" ]; then
            echo "📋 复制 AI 助手文档到项目目录..."
            cp "$TEMP_DOCS_DIR/llms"/* . 2>/dev/null || true
            git add llms.txt llms-full.txt 2>/dev/null || true
            echo "✅ AI 助手文档已复制并暂存"
          fi
          
          # 显示最终暂存区状态
          STAGED_FILES=$(git diff --cached --name-only)
          if [ -n "$STAGED_FILES" ]; then
            echo ""
            echo "📊 最终暂存区统计："
            echo "$STAGED_FILES"
            
            # 分类统计
            PYTHON_COUNT=$(echo "$STAGED_FILES" | grep "python/docs/api" | wc -l || echo "0")
            TYPESCRIPT_COUNT=$(echo "$STAGED_FILES" | grep "typescript/docs/api/" | wc -l || echo "0")
            GOLANG_COUNT=$(echo "$STAGED_FILES" | grep "golang/docs/api/" | wc -l || echo "0")
            LLMS_COUNT=$(echo "$STAGED_FILES" | grep -E "(llms\.txt|llms-full\.txt)" | wc -l || echo "0")
            
            echo "🐍 Python 文档: $PYTHON_COUNT 个文件"
            echo "📘 TypeScript 文档: $TYPESCRIPT_COUNT 个文件"
            echo "🐹 Golang 文档: $GOLANG_COUNT 个文件"
            echo "🤖 AI 助手文档: $LLMS_COUNT 个文件"
            echo "📁 最终生成的文档目录结构："
            for doc_dir in "python/docs/api" "typescript/docs/api" "golang/docs/api"; do
              if [ -d "$doc_dir" ]; then
                echo "📂 $doc_dir:"
                find "$doc_dir" -type f -name "*.md" | head -10 | sed 's/^/  /'
              fi
            done
            for llms_file in "llms.txt" "llms-full.txt"; do
              if [ -f "$llms_file" ]; then
                echo "📄 $llms_file: $(wc -l < "$llms_file") 行"
              fi
            done
          else
            echo "⚠️ 没有文件被暂存"
          fi
      # 提交文档变更
      - id: commit-docs
        name: "提交文档变更"
        run: |
          # 检查是否为 CI 机器人提交或自动提交被禁用
          if [ "$CI_LOOP_DETECTED" = true ]; then
            echo "⚠️ 检测到 CI 机器人提交，跳过文档提交"
            exit 0
          fi
          
          # 检查自动提交是否启用（默认启用）
          if [ "${{params.auto_commit_enabled}}" != "true" ]; then
            echo "ℹ️ 自动提交已禁用，跳过"
            exit 0
          fi
          
          tree "$TEMP_DOCS_DIR" || ls -la "$TEMP_DOCS_DIR"
          echo "📤 开始检查并提交文档变更..."
          
          # 配置 Git 用户信息（checkout 组件已处理认证）
          git config --global user.name "wuying-ai-team"
          git config --global user.email "wuying-ai-team@alibabacloud.com"
          echo "✅ Git 用户配置完成"
          
          # 检查暂存区是否有文件（从临时目录复制的文档已经添加到暂存区）
          STAGED_FILES=$(git diff --cached --name-only)
          
          if [ -z "$STAGED_FILES" ]; then
            echo "ℹ️  暂存区没有文件，跳过提交步骤"
            echo "📋 检查临时目录状态："
            find "$TEMP_DOCS_DIR" -type f 2>/dev/null || echo "临时目录为空"
            exit 0
          fi
          
          echo "📋 暂存区中的文档文件："
          echo "$STAGED_FILES"
          
          # 由于文件是从受控的临时目录复制的，应该都是文档相关文件
          # 但仍然进行验证以确保安全
          NON_DOC_FILES=$(echo "$STAGED_FILES" | grep -v -E "(python/docs/api/|typescript/docs/api/|golang/docs/api/|llms\.txt|llms-full\.txt)" || true)
          if [ -n "$NON_DOC_FILES" ]; then
            echo "⚠️  警告：发现非预期的文件类型："
            echo "$NON_DOC_FILES"
            echo "📋 这些文件将不会被提交"
            
            # 重置暂存区，只保留文档文件
            git reset HEAD
            DOC_FILES=$(echo "$STAGED_FILES" | grep -E "(python/docs/api/|typescript/docs/api/|golang/docs/api/|llms\.txt|llms-full\.txt)" || true)
            if [ -n "$DOC_FILES" ]; then
              echo "$DOC_FILES" | while read -r file; do
                if [ -n "$file" ] && [ -f "$file" ]; then
                  echo "➕ 重新暂存文档文件: $file"
                  git add "$file"
                fi
              done
            fi
            
            # 重新检查暂存区
            STAGED_FILES=$(git diff --cached --name-only)
            if [ -z "$STAGED_FILES" ]; then
              echo "ℹ️  没有有效的文档文档可提交，跳过提交步骤"
              exit 0
            fi
          fi
          
          echo "📝 准备提交以下文档文件："
          echo "$STAGED_FILES"
          
          # 保存当前分支名和目标分支
          CURRENT_BRANCH=$(git branch --show-current)
          TARGET_BRANCH="${{git.merge_request.targetBranch}}"
          TIMESTAMP=$(date +"%Y%m%d_%H%M%S")
          DOC_BRANCH="docs/auto-generate-${TIMESTAMP}"
          
          echo "🌿 当前分支: $CURRENT_BRANCH"
          echo "🎯 目标分支: $TARGET_BRANCH" 
          echo "📄 文档分支: $DOC_BRANCH"
          
          # 创建干净的文档分支，基于目标分支
          echo "🌿 创建干净的文档分支..."
          git fetch origin "$TARGET_BRANCH" || echo "⚠️ 无法获取目标分支，使用当前状态"
          
          # 基于目标分支创建新的文档分支
          if git show-ref --verify --quiet "refs/remotes/origin/$TARGET_BRANCH"; then
            echo "✅ 基于远程目标分支 origin/$TARGET_BRANCH 创建文档分支"
            git checkout -b "$DOC_BRANCH" "origin/$TARGET_BRANCH"
          else
            echo "⚠️ 远程目标分支不存在，基于当前 HEAD 创建文档分支"
            git checkout -b "$DOC_BRANCH"
          fi
          
          # 将文档文件复制到新分支
          echo "📋 将文档文件应用到干净分支..."
          
          # 重新复制文档文件到新分支
          if [ -d "$TEMP_DOCS_DIR/python/api" ] && [ "$(find "$TEMP_DOCS_DIR/python/api" -type f 2>/dev/null)" ]; then
            echo "📋 应用 Python API 文档..."
            mkdir -p python/docs/api
            cp -r "$TEMP_DOCS_DIR/python/api"/* python/docs/api/ 2>/dev/null || true
            git add python/docs/api/
          fi
          
          if [ -d "$TEMP_DOCS_DIR/typescript/api" ] && [ "$(find "$TEMP_DOCS_DIR/typescript/api" -type f 2>/dev/null)" ]; then
            echo "📋 应用 TypeScript API 文档..."
            mkdir -p typescript/docs/api
            cp -r "$TEMP_DOCS_DIR/typescript/api"/* typescript/docs/api/ 2>/dev/null || true
            git add typescript/docs/api/
          fi
          
          if [ -d "$TEMP_DOCS_DIR/golang/api" ] && [ "$(find "$TEMP_DOCS_DIR/golang/api" -type f 2>/dev/null)" ]; then
            echo "📋 应用 Golang API 文档..."
            mkdir -p golang/docs/api
            cp -r "$TEMP_DOCS_DIR/golang/api"/* golang/docs/api/ 2>/dev/null || true
            git add golang/docs/api/
          fi
          
          if [ -d "$TEMP_DOCS_DIR/llms" ] && [ "$(find "$TEMP_DOCS_DIR/llms" -type f 2>/dev/null)" ]; then
            echo "📋 应用 AI 助手文档..."
            cp "$TEMP_DOCS_DIR/llms"/* . 2>/dev/null || true
            git add llms.txt llms-full.txt 2>/dev/null || true
          fi
          
          # 检查是否有文件需要提交
          FINAL_STAGED_FILES=$(git diff --cached --name-only)
          if [ -z "$FINAL_STAGED_FILES" ]; then
            echo "ℹ️  在干净分支上没有文档变更，跳过提交"
            git checkout "$CURRENT_BRANCH"
            git branch -D "$DOC_BRANCH"
            exit 0
          fi
          
          echo "📝 在干净分支上准备提交以下文档文件："
          echo "$FINAL_STAGED_FILES"
          
          # 创建提交信息
          COMMIT_MESSAGE="🤖 自动生成文档

          - 更新 API 文档（基于源代码变更）
          - 重新生成 AI 助手文档 (llms.txt, llms-full.txt)
          - 同步文档与最新代码变更

          生成者: wuying-ai-team
          触发分支: ${{git.branch}}
          提交commit id: ${{git.commitId}}"
          
          # 在干净分支上提交文档变更
          git commit -m "$COMMIT_MESSAGE"
          echo "✅ 在干净分支 $DOC_BRANCH 上提交文档变更完成"
          
          # 推送文档分支到远程并创建 CR 评审
          git push origin "$DOC_BRANCH"
          echo "✅ 推送文档分支到远程完成"
          
          # 使用 git push 的 refs/for 语法创建 CR 评审
          echo "🔄 推送到 CR 评审系统..."
          git push origin "HEAD:refs/for/$TARGET_BRANCH" || {
            echo "⚠️ 使用 refs/for 推送失败，尝试其他方式..."
            
            # 如果 refs/for 失败，尝试使用 git 命令创建 MR
            if command -v git-review >/dev/null 2>&1; then
              echo "📋 使用 git-review 创建评审..."
              git review -t "$CR_TITLE" -m "$CR_DESCRIPTION" || echo "⚠️ git-review 创建失败"
            else
              echo "📋 git-review 不可用，记录 CR 信息供后续处理..."
            fi
          }
          
          # 切换回原分支
          git checkout "$CURRENT_BRANCH"
          echo "🔄 已切换回原分支: $CURRENT_BRANCH"
          
          # 输出 CR 创建结果
          echo ""
          echo "✅ 文档分支和 CR 评审创建完成！"
          echo "📋 CR 评审信息："
          echo "  - 源分支: $DOC_BRANCH"
          echo "  - 目标分支: $TARGET_BRANCH"
          echo "  - 标题: $CR_TITLE"
          echo "  - 包含文件: $(echo "$FINAL_STAGED_FILES" | wc -l) 个文档文件"
          echo ""
          echo "🔍 请在代码评审系统中查看和处理此 CR："
          echo "   - 检查文档内容的准确性"
          echo "   - 确认 API 文档与代码同步"
          echo "   - 验证 AI 助手文档的完整性"
          echo "   - 批准后合并到 $TARGET_BRANCH 分支"
