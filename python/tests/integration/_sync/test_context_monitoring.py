# DO NOT EDIT THIS FILE MANUALLY.
# This file is auto-generated by scripts/generate_sync.py

import sys
import os
import pytest
import importlib.util
from pathlib import Path

# Add project root to path
PROJECT_ROOT = (
    Path(__file__).resolve().parents[4]
)  # Adjusted for deeper path: python/tests/integration/_async/
sys.path.append(str(PROJECT_ROOT))

from agentbay import AgentBayError


@pytest.mark.sync
def test_context_sync_monitoring_example():
    """
    Integration test for context_sync_monitoring_example.py
    This test executes the main function of the example script.
    """
    # Determine mode based on directory name of this file
    # python/tests/integration/_async/test.py -> mode=_async
    current_dir = Path(__file__).parent.name
    mode = "_sync" if current_dir == "_sync" else "_sync"

    # Path to the example file
    example_path = (
        PROJECT_ROOT
        / f"python/docs/examples/{mode}/common-features/basics/data_persistence/context_sync_monitoring_example.py"
    )

    assert example_path.exists(), f"Example file not found at {example_path}"

    # Load the module dynamically
    spec = importlib.util.spec_from_file_location(
        "context_sync_monitoring_example", example_path
    )
    module = importlib.util.module_from_spec(spec)
    sys.modules[f"context_sync_monitoring_example_{mode}"] = module
    spec.loader.exec_module(module)

    # Run the main function
    try:
        if mode == "_sync":
            module.main()
        else:
            module.main()
    except Exception as e:
        pytest.fail(f"Example execution failed: {e}")
