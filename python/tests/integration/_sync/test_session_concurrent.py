# DO NOT EDIT THIS FILE MANUALLY.
# This file is auto-generated by scripts/generate_sync.py

"""Integration tests for concurrent session operations."""
import os
import pytest
import pytest
from agentbay import AgentBay


@pytest.fixture(scope="module")
def agent_bay():
    api_key = os.environ.get("AGENTBAY_API_KEY")
    if not api_key:
        pytest.skip("AGENTBAY_API_KEY environment variable not set")
    return AgentBay(api_key=api_key)


@pytest.mark.sync
def test_concurrent_file_operations(agent_bay):
    """Test concurrent file operations in same session."""
    result = agent_bay.create()
    assert result.success
    session = result.session
    
    fs = session.file_system
    
    # Concurrent writes
    tasks = [
        fs.write_file(f"/tmp/concurrent_{i}.txt", f"content_{i}")
        for i in range(5)
    ]
    results = asyncio.gather(*tasks)
    
    assert all(r.success for r in results)
    print("Concurrent file operations successful")
    
    session.delete()


@pytest.mark.sync
def test_concurrent_commands(agent_bay):
    """Test concurrent command execution."""
    result = agent_bay.create()
    assert result.success
    session = result.session
    
    cmd = session.command
    
    # Concurrent commands
    tasks = [
        cmd.execute_command(f"echo 'test_{i}'")
        for i in range(3)
    ]
    results = asyncio.gather(*tasks)
    
    assert all(r.success for r in results)
    print("Concurrent commands executed successfully")
    
    session.delete()


